# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ PostgreSQL –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã —á–µ—Ä–µ–∑ Ansible

## üñ•Ô∏è –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

- –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –¥–≤—É–º —É–¥–∞–ª—ë–Ω–Ω—ã–º —Å–µ—Ä–≤–µ—Ä–∞–º –ø–æ SSH (–æ–¥–∏–Ω –Ω–∞ Debian, –≤—Ç–æ—Ä–æ–π –Ω–∞ AlmaLinux)
- –ò–∑–º–µ—Ä—è–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –∏ –≤—ã–±–∏—Ä–∞–µ—Ç –º–µ–Ω–µ–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π —Ö–æ—Å—Ç
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç PostgreSQL –Ω–∞ —Ü–µ–ª–µ–≤–æ–º —Ö–æ—Å—Ç–µ
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –ë–î –∏–∑–≤–Ω–µ
- –°–æ–∑–¥–∞—ë—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `student` —Å –¥–æ—Å—Ç—É–ø–æ–º —Ç–æ–ª—å–∫–æ —Å IP –≤—Ç–æ—Ä–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î —á–µ—Ä–µ–∑ `SELECT 1`

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —è —Ä–∞–∑–≤–µ—Ä–Ω—É–ª 2 –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã –≤ VirtualBox:

1. –ù–∞—Å—Ç—Ä–æ–∏–ª `host-only` —Å–µ—Ç—å, —á—Ç–æ–±—ã —Ö–æ—Å—Ç –º–æ–≥ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –í–ú. –ü—Ä–∏–º–µ—Ä—ã IP –ø–æ DHCP:
   - AlmaLinux: `192.168.56.106`
   - Debian: `192.168.56.105`

2. –ù–∞—Å—Ç—Ä–æ–∏–ª –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ SSH:
   - –í `/etc/ssh/sshd_config` –Ω–∞ –∫–∞–∂–¥–æ–π –º–∞—à–∏–Ω–µ:
     - –í—Ä–µ–º–µ–Ω–Ω–æ –≤–∫–ª—é—á–∏–ª `PasswordAuthentication yes` –∏ `PermitRootLogin yes`
     - –ó–∞–≥—Ä—É–∑–∏–ª –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á:  
       `ssh-copy-id -i ~/.ssh/ansible_key.pub root@<ip-–∞–¥—Ä–µ—Å>`
     - –û—Ç–∫–ª—é—á–∏–ª –ø–∞—Ä–æ–ª—å–Ω—É—é –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –æ–±—Ä–∞—Ç–Ω–æ (`PasswordAuthentication no`, `PubkeyAuthentication yes`)

---

## –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `ansible` –∏—Å–ø–æ–ª—å–∑—É—è –ø–∞–∫–µ—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –û–°. –ü—Ä–∏–º–µ—Ä –Ω–∞ Debian/Ubuntu:
```bash
sudo apt update
sudo apt install -y ansible
```

### 3. –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –∑–∞–ø—É—Å–∫a
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∫–∞–∫ ip –∞–¥—Ä–µ—Å–∞ –º–∞—à–∏–Ω –∏ —Ç–∞–∫ —Ö–æ—Å—Ç–Ω–µ–π–º.
```bash
sudo python3 deploy.py --key ~/.ssh/ansible_key --db_password pass123 "192.168.56.105,192.168.56.106"
```
–∏–ª–∏
```bash
chmod +x deploy.py
sudo ./deploy.py --key ~/.ssh/ansible_key --db_password pass123 "alma-vm,debian-vm"
```

### –í–æ–∑–Ω–∏–∫—à–∏–µ –≤–æ–ø—Ä–æ—Å—ã
1. ansible –Ω–µ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å * –≤ –ø—É—Ç—è—Ö –∫ —Ñ–∞–π–ª–∞–º, –¥–æ–±–∞–≤–∏–ª —Ç–∞—Å–∫–∏ –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –æ–ø—Ä–µ–¥–∏–ª–µ–Ω–∏—è –ø—É—Ç–µ–π.
2. ansible –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –º–∞—à–∏–Ω–∞—Ö —á–µ—Ä–∑–µ python –∏ –≤ –¥–ª—è —Ç–∞—Å–∫–∏ "Create user=student" –ø—Ä–∏—à–ª–æ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ª–∏–±—É python3-psycopg2
3. –ß—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –º–µ–∂–¥—É –º–∞—à–∏–Ω–∞–º–∏:
   1. –°–æ–∑–¥–∞–ª –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–ª–µ–π —Å —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π psql.
   2. –°–æ–∑–¥–∞–ª –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–ª–µ–π –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–∞–µ—Ä–≤–æ–ª–∞(–≤–∞–∂–Ω–æ –¥–æ–±–∞–≤–∏–ª –¥–ª—è debian –ø—Ä–∞–≤–∏–ª–æ –Ω–∞ 22 –ø–æ—Ä—Ç, —á—Ç–æ–±—ã –Ω–µ –æ–±—Ä—É–±–∏—Ç—å —Å–µ–±–µ –¥–æ—Å—Ç—É–ø).
4. –ü–∞—Ä–æ–ª—å –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è student –≤—ã–Ω–µ—Å –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –≤ —Å–∫—Ä–∏–ø—Ç —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º –ø—Ä–æ–∫–∏–¥—ã–≤–∞–µ–Ω–∏–µ–º –≤ ansible, —á—Ç–æ–±—ã –Ω–µ —Å–≤–µ—Ç–∏—Ç—å –ø–∞—Ä–æ–ª—å –≤ –∫–æ–¥–µ. 
